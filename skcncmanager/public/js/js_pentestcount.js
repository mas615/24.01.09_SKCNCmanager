
        // 서버에서 전달된 데이터를 EJS 템플릿에서 사용
    
        // Handsontable을 초기화하고 옵션을 설정합니다.
        const container = document.getElementById('example');
        const hot = new Handsontable(container, {
            data: data,
            colHeaders: [
                "구분",
                "서비스수",
                "URL수",
                "취약점수"
            ],
            rowHeaders: true,
            licenseKey: 'non-commercial-and-evaluation',
            afterPaste: (data, coords) => {
                const a = coords[0].startRow;
                const b = coords[0].endRow;
                const rowIndices = [];
                for (let i = a; i <= b; i++) {
                    // 반복하고자 하는 동작 수행
                    rowIndices.push(i);
                };
                const rowDataToSend = rowIndices.map(rowIndex => hot.getDataAtRow(rowIndex));
                console.log(rowDataToSend);

                sendRowDataToServer(rowDataToSend);
            },

            afterChange: (changes, source) => {
                if (source === 'edit') {
                    const rowIndices = changes.map(change => change[0]);
                    console.log(rowIndices);
                    const rowDataToSend = rowIndices.map(rowIndex => hot.getDataAtRow(rowIndex));
                    console.log(rowDataToSend);

                    sendRowDataToServer(rowDataToSend);
                }
            },
        });
    
        // Function to send row data to the server
        function sendRowDataToServer(rowData) {
            const sanitizedRowData = rowData.map(row => (row === undefined ? null : row));

            fetch('/m/penetrationtest/gridtest', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ rowData: sanitizedRowData }),
            })
            .then(response => response.json())
            .then(data => {
                console.log(data);
            })
            .catch(error => {
                console.error('Error updating row data:', error);
            });
        }